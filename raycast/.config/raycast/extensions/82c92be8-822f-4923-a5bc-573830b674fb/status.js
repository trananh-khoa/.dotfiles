"use strict";var f=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var x=Object.prototype.hasOwnProperty;var k=(e,t)=>{for(var n in t)f(e,n,{get:t[n],enumerable:!0})},R=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of C(t))!x.call(e,r)&&r!==n&&f(e,r,{get:()=>t[r],enumerable:!(i=I(t,r))||i.enumerable});return e};var M=e=>R(f({},"__esModule",{value:!0}),e);var T={};k(T,{checkSchedule:()=>b,default:()=>w});module.exports=M(T);var s=require("@raycast/api");var a=require("@raycast/api"),o=require("node:child_process");async function p(e,t,n){t&&await(0,a.showHUD)(t),await c({menubar:!1,status:!1}),(0,o.exec)(`/usr/bin/caffeinate ${N(n)} || true`),await m(e,!0)}async function c(e,t){t&&await(0,a.showHUD)(t),(0,o.execSync)("/usr/bin/killall caffeinate || true"),await m(e,!1)}async function m(e,t){e.menubar&&await g("index",{caffeinated:t}),e.status&&await g("status",{caffeinated:t})}async function g(e,t){try{await(0,a.launchCommand)({name:e,type:a.LaunchType.Background,context:t})}catch{}}function N(e){let t=(0,a.getPreferenceValues)(),n=[];return t.preventDisplay&&n.push("d"),t.preventDisk&&n.push("m"),t.preventSystem&&n.push("i"),e&&n.push(` ${e}`),n.length>0?`-${n.join("")}`:""}function O(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]}async function S(){let t=O(new Date().getDay()).toLowerCase(),n=await a.LocalStorage.getItem(t);return n===void 0?void 0:JSON.parse(n)}var D=require("node:child_process");function L(){try{return(0,D.execSync)("pgrep caffeinate"),!0}catch{return!1}}async function v(e){if(!e||Object.keys(e).length===0)return!1;let t=new Date,[n,i]=e.from.split(":").map(Number),[r,d]=e.to.split(":").map(Number),u=t.getHours(),l=t.getMinutes(),y=(u>n||u===n&&l>=i)&&(u<r||u===r&&l<d);if(y===!1&&e.IsRunning===!0)return e.IsRunning=!1,await c({menubar:!0,status:!0}),await s.LocalStorage.setItem(e.day,JSON.stringify(e)),!1;if(y===!0&&e.IsRunning===!1){let h=(r-n)*3600+(d-i)*60;return await p({menubar:!0,status:!0},void 0,`-t ${h}`),e.IsRunning=!0,await s.LocalStorage.setItem(e.day,JSON.stringify(e)),!0}return!1}async function b(){let e=await S();return e===void 0||e.IsManuallyDecafed?!1:await v(e)}async function w(){let e=L(),t=await b(),n="\u2716 Decaffeinated";(e||t)&&(n="\u2714 Caffeinated"),(0,s.updateCommandMetadata)({subtitle:n})}0&&(module.exports={checkSchedule});
